# Pie chart
The following are some basic steps to generate a pie chart using Python's Matplotlib library.

### 1. Install and import required libraries
Install `openpyxl` - a library to read and write Excel files.
```python
!conda install -c anaconda openpyxl --y
```

Use inline backend to generate the plots within the browser.
```python
import pandas as pd  # Scientific computing library
import numpy as np   # Data structure library

import matplotlib as mpl
import matplotlib.pyplot as plt
mpl.style.use("ggplot")

%matplotlib inline
```
### 2. About the dataset
This example uses the Canadian Immigration dataset (1980 - 2013) from the [United Nation International Migration](https://www.un.org/en/development/desa/population/migration/data/empirical2/migrationflows.asp).

The dataset contains annual data on the flows of international migrants as recorded by the countries of destination. The data presents both inflows and outflows according to the place of birth, citizenship or place of previous / next residence both for foreigners and nationals. 

The file format is in **.xlsx** - an Excel spreadsheet file.

### 3. Data preparation
#### 3.1. Download the dataset
**Download** the dataset **provided in this repository** and replace the file path between the quotation marks " " with the file path on your computer.
Load it into a **pandas** DataFrame.
```python
path_excel = "/insert-your-file-path-here/UN_Canada.xlsx"

df_cad = pd.read_excel(path_excel,
                       sheet_name = "Canada by Citizenship",
                       skiprows = range(20),
                       skipfooter = 2)
```

Let's have a look at the first five items in the dataset.
```python
df.cad_head()
```
<img width="1220" alt="table_1" src="https://user-images.githubusercontent.com/72127249/163404042-9d998718-647d-4c68-842b-15a1ded8bab5.png">

#### 3.2. Tidy up the data
```python
# Remove unnecessary columns
df.drop(["AREA", "REG", "DEV", "Type", "Coverage"], axis = 1, inplace = True)

# Rename the columns
df.rename(columns = {"OdName":"Country", "AreaName":"Continent", "RegName":"Region"}, inplace = True)

# Make all column labels of type string
df.columns = list(map(str, df.columns))

# Set the country's name as index
df.set_index("Country", inplace = True)

# Add total column
df["Total"] = df.sum(axis = 1)
```

#### 3.3. Group the data by **continent**
We will generate a pie chart that shows the proportion of immigrations entering Canada by continents.
Let's use pandas `groupby` method to group the data by **Continent**.
```python
df_continents = df.groupby("Continent", axis = 0).sum()

df_continents.head()
```
<img width="1242" alt="p_2" src="https://user-images.githubusercontent.com/72127249/163404705-7bf1ebbd-115c-4006-abb9-a37c5dbea1df.png">

### 4. Visualization: Pie chart
Let's use the following parameters to build our pie chart:
* `autopct` - a string or function used to label the pie's wedges with their values. The label will be placed inside the wedges. If it is a format string, the label will be fmt%pct;
* `startangle` - rotates the start of the pie chart by angle degrees counterclockwise from the x-axis;
* `shadow` - draws a shadow beneath the pie;
*  Set the `labels` to None to remove the labels from the pie chart and add a separate legend using `plt.legend()`;
* `pctdistance` - the ratio between the center of each pie slice and the start of the text generated by autopct. We will provide a value such that the labels will lie outside the pie wedges;
*  Use preferred colours by passing in some color's names to `colors` parameter;
*  Use `explode` to specify the fraction of the radius with which to offset each wedge.

**Note**:  
We can always change the colours of our charts by specifying the colours' names in our codes. To get the colours' names available in Matplotlib, run the following code:
```python
import matplotlib
for name, hex in matplotlib.colors.cnames.items():
    print(name, hex)
```

```python
color_list = ["gold", "mediumturquoise", "lightcoral", "lightskyblue", "lightgreen", "pink"]

explode_list = [0.1, 0, 0, 0, 0.1, 0.1]  # offset the wedges of 3 continents with the lowest immigrations

df_continents["Total"].plot(kind = "pie",
                            figsize = (15, 6),
                            autopct = "%1.1f%%",
                            startangle = 90,
                            shadow = True,
                            labels = None,
                            pctdistance = 1.12,
                            colors = color_list,
                            explode = explode_list)

plt.title("Immigration to Canada by Continent 1980 - 2013", y = 1.12)

plt.axis("equal") # sets the pie chart to look like a circle

plt.legend(labels = df_continents.index, loc = "upper left")

plt.show()
```
<img width="748" alt="p_3" src="https://user-images.githubusercontent.com/72127249/163404334-f453e67c-0a81-4492-94b5-6bb437addeed.png">

### References:
[Matplotlib Pie chart](https://matplotlib.org/3.1.1/api/_as_gen/matplotlib.axes.Axes.pie.html)
